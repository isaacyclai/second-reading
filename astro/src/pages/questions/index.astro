---
import Layout from "../../layouts/Layout.astro";
import SectionLabel from "../../components/SectionLabel.astro";
import QuestionCard from "../../components/QuestionCard.astro";
import PaginatedList from "../../components/PaginatedList.astro";
import { getQuestions, getQuestionCount } from "../../lib/db";

const PAGE_SIZE = 20;
const totalCount = getQuestionCount();
const questions = getQuestions(PAGE_SIZE, 0);
---

<Layout
  title="Questions"
  description="Browse Singapore Parliament questions and answers"
>
  <SectionLabel>Question Time</SectionLabel>

  <h1 class="font-display text-display-lg text-ink mb-4">
    Parliamentary Questions
  </h1>

  <p
    class="font-body text-base text-ink-soft leading-relaxed max-w-[58ch] mb-8"
  >
    Browse parliamentary questions and their answers. Questions can be oral
    (OA), written (WA), or written without answer (WANA). Click on a question to
    see the full transcript.
  </p>

  <PaginatedList
    containerId="questions-list"
    itemSelector=".question-item"
    contentType="question"
    dataUrl="/data/questions.json"
    totalCount={totalCount}
    pageSize={PAGE_SIZE}
    placeholder="Search questions by title, speaker, or content..."
  >
    <div id="questions-list" class="flex flex-col border-t border-border">
      {
        questions.length === 0 ? (
          <p class="py-12 text-center font-body text-ink-muted">
            No questions found
          </p>
        ) : (
          questions.map((question, i) => (
            <div
              class="question-item animate-fade-up"
              style={`animation-delay: ${0.1 + Math.min(i, 20) * 0.03}s`}
            >
              <QuestionCard section={question} />
            </div>
          ))
        )
      }
    </div>
  </PaginatedList>
</Layout>
