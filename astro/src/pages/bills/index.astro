---
import Layout from "../../layouts/Layout.astro";
import SectionLabel from "../../components/SectionLabel.astro";
import PaginatedList from "../../components/islands/PaginatedList";
import { getBills, getBillCount } from "../../lib/db";
import type { ListItem } from "../../lib/types";

const PAGE_SIZE = 24;
const totalCount = getBillCount();
const bills = getBills(PAGE_SIZE, 0);

// Transform to match the ListItem interface
const initialItems: ListItem[] = bills.map((b) => ({
  id: b.id,
  title: b.title,
  ministry: b.ministry || undefined,
  firstReadingDate: b.firstReadingDate || undefined,
}));
---

<Layout title="Bills" description="Browse Singapore Parliament bills">
  <SectionLabel>Legislation</SectionLabel>

  <h1 class="font-display text-display-lg text-ink mb-4">
    Bills Before Parliament
  </h1>

  <p
    class="font-body text-base text-ink-soft leading-relaxed max-w-[58ch] mb-8"
  >
    Bills are proposed laws that are debated, amended, and voted on in
    Parliament. Track their progress from first reading through to passage.
  </p>

  <PaginatedList
    client:visible
    contentType="bill"
    dataUrl="/data/bills.json"
    totalCount={totalCount}
    pageSize={PAGE_SIZE}
    placeholder="Search bills by title or ministry..."
    initialItems={initialItems}
  />
</Layout>
